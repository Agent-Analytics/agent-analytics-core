// AUTO-GENERATED â€” edit tracker.src.js instead
export const TRACKER_JS = `(function(){"use strict";var i=document.currentScript,w=i&&i.src?new URL(i.src).origin+"/track":"/track",M=i&&i.dataset.project||"default",_=i&&i.dataset.token||null,O=i&&i.getAttribute("data-link-domains")||null,o=null;O&&(o=O.split(",").map(function(e){return e.trim().toLowerCase()}));function N(e){if(!o||e===location.hostname)return!1;for(var r=0;r<o.length;r++){var t=o[r];if(e===t||e.endsWith("."+t))return!0}return!1}function R(){if(!o)return null;var e=new URLSearchParams(location.search),r=e.get("_aa");if(r){localStorage.setItem("aa_uid",r),e.delete("_aa");var t=location.pathname+(e.toString()?"?"+e.toString():"")+location.hash;return history.replaceState(null,"",t),r}return null}function D(){var e=R()||localStorage.getItem("aa_uid");return e||(e="anon_"+Math.random().toString(36).slice(2,11)+Date.now().toString(36),localStorage.setItem("aa_uid",e)),e}var d=D();o&&document.addEventListener("click",function(e){var r=e.target.closest?e.target.closest("a"):null;if(!(!r||!r.href))try{var t=new URL(r.href);N(t.hostname)&&(t.searchParams.set("_aa",d),r.href=t.toString())}catch(a){}});var F=1800*1e3;function B(){var e=Date.now(),r=parseInt(sessionStorage.getItem("aa_last_activity")||"0",10),t=sessionStorage.getItem("aa_sid");return(!t||r&&e-r>F)&&(t="sess_"+Math.random().toString(36).slice(2,11)+e.toString(36),sessionStorage.setItem("aa_sid",t)),sessionStorage.setItem("aa_last_activity",String(e)),t}function E(){for(var e=new URLSearchParams(location.search),r={},t=["utm_source","utm_medium","utm_campaign","utm_content","utm_term"],a=0;a<t.length;a++){var n=e.get(t[a]);n&&(r[t[a]]=n)}return r}var v=E();function J(e){var r="Unknown",t="",a="Unknown",n;return(n=e.match(/(Edge|Edg)\\/([\\d.]+)/))?(r="Edge",t=n[2]):(n=e.match(/OPR\\/([\\d.]+)/))?(r="Opera",t=n[1]):(n=e.match(/Chrome\\/([\\d.]+)/))?(r="Chrome",t=n[1]):(n=e.match(/Safari\\/([\\d.]+)/))?(n=e.match(/Version\\/([\\d.]+)/))&&(r="Safari",t=n[1]):(n=e.match(/Firefox\\/([\\d.]+)/))&&(r="Firefox",t=n[1]),/iPhone|iPad|iPod/.test(e)?a="iOS":/Windows/.test(e)?a="Windows":/Android/.test(e)?a="Android":/CrOS/.test(e)?a="ChromeOS":/Mac OS X/.test(e)?a="macOS":/Linux/.test(e)&&(a="Linux"),{browser:r,browser_version:t.split(".")[0],os:a}}var h=navigator.userAgent||"",c=J(h);function W(){var e=screen.width;return/Tablet|iPad/i.test(h)||e>=768&&e<1024&&!/Mobi/i.test(h)?"tablet":/Mobi/i.test(h)||e<768?"mobile":"desktop"}c.device=W();var b=[],y=null,q=5e3;function P(e,r){navigator.sendBeacon&&navigator.sendBeacon(e,new Blob([r],{type:"text/plain"}))||fetch(e,{method:"POST",body:r,keepalive:!0,credentials:"omit"}).catch(function(){})}function k(){if(b.length){var e=b.splice(0);e.length===1?P(w,JSON.stringify(e[0])):P(w.replace("/track","/track/batch"),JSON.stringify({events:e}))}}function H(){y||(y=setTimeout(function(){y=null,k()},q))}document.addEventListener("visibilitychange",function(){document.visibilityState==="hidden"&&k()}),window.addEventListener("beforeunload",k);function K(e){var r={url:location.href,path:location.pathname,hostname:location.hostname,referrer:document.referrer,title:document.title,screen:screen.width+"x"+screen.height,language:navigator.language||"",browser:c.browser,browser_version:c.browser_version,os:c.os,device:c.device};for(var t in v)v.hasOwnProperty(t)&&(r[t]=v[t]);if(e)for(var a in e)e.hasOwnProperty(a)&&(r[a]=e[a]);return r}var g={},l=null,s={track:function(e,r){b.push({project:M,token:_,event:e,properties:K(r),user_id:d,session_id:B(),timestamp:Date.now()}),H()},identify:function(e){d=e,localStorage.setItem("aa_uid",e)},page:function(e){this.track("page_view",{page:e||document.title})},experiment:function(e,r){if(g[e]!==void 0)return g[e];var t=null;if(l){for(var a=0;a<l.length;a++)if(l[a].key===e){t=l[a];break}}if(!t&&r){var n=Math.floor(100/r.length),m=100-n*r.length;t={key:e,variants:r.map(function($,j){return{key:$,weight:n+(j===0?m:0)}})}}if(!t)return null;var u=new URLSearchParams(location.search).get("aa_variant_"+e);if(u){for(var I=0;I<t.variants.length;I++)if(t.variants[I].key===u)return g[e]=u,s.track("$experiment_exposure",{experiment:e,variant:u,forced:!0}),u}for(var T=e+"."+d,f=0,L=0;L<T.length;L++)f=(f<<5)-f+T.charCodeAt(L),f|=0;for(var V=Math.abs(f)%100,U=0,p=t.variants[0].key,S=0;S<t.variants.length;S++)if(U+=t.variants[S].weight,V<U){p=t.variants[S].key;break}return g[e]=p,s.track("$experiment_exposure",{experiment:e,variant:p}),p}};function x(){for(var e=document.querySelectorAll("[data-aa-experiment]"),r=0;r<e.length;r++){var t=e[r],a=t.getAttribute("data-aa-experiment"),n=s.experiment(a);if(n){var m=t.getAttribute("data-aa-variant-"+n.toLowerCase());m!==null&&(t.innerHTML=m)}}document.documentElement.classList.remove("aa-loading")}(function(){if(!_){x();return}var r=w.replace("/track","/experiments/config")+"?token="+_;fetch(r,{credentials:"omit"}).then(function(t){return t.json()}).then(function(t){l=t.experiments||[],x()}).catch(function(){x()})})();var A=location.pathname+location.search;function C(){var e=location.pathname+location.search;e!==A&&(A=e,v=E(),s.page())}window.addEventListener("popstate",C),["pushState","replaceState"].forEach(function(e){var r=history[e];history[e]=function(){var t=r.apply(this,arguments);return C(),t}}),s.page(),window.aa=s})();`;
